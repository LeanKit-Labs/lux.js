{"version":3,"sources":["webpack://lux/webpack/universalModuleDefinition","webpack://lux/webpack/bootstrap","webpack://lux/./src/utils.js","webpack://lux/./src/bus.js","webpack://lux/./src/actions.js","webpack://lux/external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack://lux/./src/dispatcher.js","webpack://lux/./src/mixins/index.js","webpack://lux/./src/mixins/actionCreator.js","webpack://lux/./src/lux.js","webpack://lux/(webpack)/buildin/global.js","webpack://lux/./src/printUtils.js","webpack://lux/external \"postal\"","webpack://lux/external \"machina\"","webpack://lux/./src/mixins/store.js","webpack://lux/./src/mixins/actionListener.js","webpack://lux/./src/mixins/luxWrapper.js","webpack://lux/external {\"root\":\"React\",\"commonjs\":\"react\",\"commonjs2\":\"react\",\"amd\":\"react\"}","webpack://lux/./src/mixins/wrapperUtils.js","webpack://lux/./src/store.js"],"names":["ensureLuxProp","entries","context","__lux","cleanup","subscriptions","obj","indexOf","Object","keys","k","printActions","printStoreDepTree","actionChannel","postal","channel","storeChannel","dispatcherChannel","generateActionCreator","getActionGroup","getGroupsWithAction","customActionCreator","addToActionGroup","actions","create","actionGroups","actionList","forEach","action","args","Array","from","arguments","publish","topic","data","actionType","actionArgs","group","_","pick","Error","actionName","groups","list","push","assign","groupName","diff","difference","length","join","calculateGen","store","lookup","gen","namespaces","calcdGen","_namespaces","namespace","waitFor","dep","depStore","thisGen","console","warn","buildGenerations","stores","tree","key","item","processGeneration","generation","map","deps","Dispatcher","initialState","actionMap","states","ready","_onEnter","actionContext","undefined","dispatching","luxAction","generations","call","transition","hasChanged","updated","_onExit","notifying","nothandled","getStoresHandling","createSubscribers","generationIndex","handle","storeMeta","actionDef","actionMeta","isThisNameSpace","meta","v","idx","findIndex","splice","__subscriptions","subscribe","handleActionDispatch","constraint","subscription","unsubscribe","machina","BehavioralFsm","mixin","mixins","storeMixin","actionCreatorMixin","mxn","setup","teardown","luxCleanup","method","actionCreator","actionListener","actionListenerMixin","reactMixin","actionCreatorReactMixin","storeReactMixin","target","actionCreatorListener","dispatch","luxWrapper","getActions","addActionIfNotPresent","componentWillMount","global","window","_babelPolyfill","publishAction","log","dispatcher","removeStore","Store","utils","x","s","table","groupEnd","at","t","pop","gateKeeper","instance","payload","found","heardFrom","onChange","handlePreNotify","filter","listenTo","prenotify","sub","split","componentWillUnmount","handlers","handlerFn","subs","handler","apply","handlerKeys","Component","getState","pureComponent","componentDidMount","componentWillReceiveProps","componentWillUpdate","componentDidUpdate","getComponentState","props","initialPayload","reduce","m","LuxWrapper","state","setState","React","createElement","propToAction","displayName","setupStoreListener","isSyntheticEvent","getDefaultActionCreator","setupActionMap","e","hasOwnProperty","prototype","toString","unshift","childProp","buildActionList","ensureStoreOptions","options","getHandlerObject","listeners","changed","listener","bind","updateWaitFor","source","handlerObject","addListeners","processStoreArgs","otherOpts","o","opt","clone","merge","inDispatch","newState","replaceState","flush","res","concat","__subscription","notify","registerStore","dispose"],"mappings":"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","file":"lux.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"postal\"), require(\"machina\"), require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"postal\", \"machina\", \"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"lux\"] = factory(require(\"lodash\"), require(\"postal\"), require(\"machina\"), require(\"react\"));\n\telse\n\t\troot[\"lux\"] = factory(root[\"_\"], root[\"postal\"], root[\"machina\"], root[\"React\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__3__, __WEBPACK_EXTERNAL_MODULE__10__, __WEBPACK_EXTERNAL_MODULE__11__, __WEBPACK_EXTERNAL_MODULE__15__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./js/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","import { printActions, printStoreDepTree } from \"./printUtils\";\n\nexport function ensureLuxProp( context ) {\n\tconst __lux = context.__lux = ( context.__lux || {} );\n\t/*eslint-disable */\n\tconst cleanup = __lux.cleanup = ( __lux.cleanup || [] );\n\tconst subscriptions = __lux.subscriptions = ( __lux.subscriptions || {} );\n\t/* eslint-enable */\n\treturn __lux;\n}\n\nexport function *entries( obj ) {\n\tif ( [ \"object\", \"function\" ].indexOf( typeof obj ) === -1 ) {\n\t\tobj = {};\n\t}\n\tfor ( const k of Object.keys( obj ) ) {\n\t\tyield[ k, obj[ k ] ];\n\t}\n}\n\nexport default { printActions, printStoreDepTree };\n","import postal from \"postal\";\n\nconst actionChannel = postal.channel( \"lux.action\" );\nconst storeChannel = postal.channel( \"lux.store\" );\nconst dispatcherChannel = postal.channel( \"lux.dispatcher\" );\n\nexport {\n\tactionChannel,\n\tstoreChannel,\n\tdispatcherChannel,\n\tpostal\n};\n","import _ from \"lodash\";\nimport { entries } from \"./utils\";\nimport { actionChannel } from \"./bus\";\nexport const actions = Object.create( null );\nexport const actionGroups = Object.create( null );\n\nexport function generateActionCreator( actionList ) {\n\tactionList.forEach( function( action ) {\n\t\tif ( !actions[ action ] ) {\n\t\t\tactions[ action ] = function() {\n\t\t\t\tconst args = Array.from( arguments );\n\t\t\t\tactionChannel.publish( {\n\t\t\t\t\ttopic: `execute.${ action }`,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tactionType: action,\n\t\t\t\t\t\tactionArgs: args\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\t\t}\n\t} );\n}\n\n// This method is deprecated, but will remain as\n// long as the print utils need it.\n/* istanbul ignore next */\nexport function getActionGroup( group ) {\n\tif ( actionGroups[ group ] ) {\n\t\treturn _.pick( actions, actionGroups[ group ] );\n\t}\n\tthrow new Error( `There is no action group named '${ group }'` );\n}\n\n// This method is deprecated, but will remain as\n// long as the print utils need it.\n/* istanbul ignore next */\nexport function getGroupsWithAction( actionName ) {\n\tconst groups = [];\n\tfor ( const [ group, list ] of entries( actionGroups ) ) {\n\t\tif ( list.indexOf( actionName ) >= 0 ) {\n\t\t\tgroups.push( group );\n\t\t}\n\t}\n\treturn groups;\n}\n\nexport function customActionCreator( action ) {\n\tObject.assign( actions, action );\n}\n\n// This method is deprecated, but will remain as\n// long as the print utils need it.\n/* istanbul ignore next */\nexport function addToActionGroup( groupName, actionList ) {\n\tlet group = actionGroups[ groupName ];\n\tif ( !group ) {\n\t\tgroup = actionGroups[ groupName ] = [];\n\t}\n\tactionList = typeof actionList === \"string\" ? [ actionList ] : actionList;\n\tconst diff = _.difference( actionList, Object.keys( actions ) );\n\tif ( diff.length ) {\n\t\tthrow new Error( `The following actions do not exist: ${ diff.join( \", \" ) }` );\n\t}\n\tactionList.forEach( function( action ) {\n\t\tif ( group.indexOf( action ) === -1 ) {\n\t\t\tgroup.push( action );\n\t\t}\n\t} );\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","\nimport _ from \"lodash\";\nimport { dispatcherChannel, actionChannel } from \"./bus\";\nimport { entries } from \"./utils\";\nimport machina from \"machina\";\n\nfunction calculateGen( store, lookup, gen, actionType, namespaces ) {\n\tlet calcdGen = gen;\n\tconst _namespaces = namespaces || [];\n\tif ( _namespaces.indexOf( store.namespace ) > -1 ) {\n\t\tthrow new Error( `Circular dependency detected for the \"${ store.namespace }\" store when participating in the \"${ actionType }\" action.` );\n\t}\n\tif ( store.waitFor && store.waitFor.length ) {\n\t\tstore.waitFor.forEach( function( dep ) {\n\t\t\tconst depStore = lookup[ dep ];\n\t\t\tif ( depStore ) {\n\t\t\t\t_namespaces.push( store.namespace );\n\t\t\t\tconst thisGen = calculateGen( depStore, lookup, gen + 1, actionType, _namespaces );\n\t\t\t\tif ( thisGen > calcdGen ) {\n\t\t\t\t\tcalcdGen = thisGen;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tconsole.warn( `The \"${actionType}\" action in the \"${store.namespace}\" store waits for \"${dep}\" but a store with that namespace does not participate in this action.` );\n\t\t\t}\n\t\t} );\n\t}\n\treturn calcdGen;\n}\n\nfunction buildGenerations( stores, actionType ) {\n\tconst tree = [];\n\tconst lookup = {};\n\t/*eslint-disable */\n\tstores.forEach( store => lookup[ store.namespace ] = store );\n\tstores.forEach( store => store.gen = calculateGen( store, lookup, 0, actionType ) );\n\tfor ( let [ key, item ] of entries( lookup ) ) {\n\t\ttree[ item.gen ] = tree[ item.gen ] || [];\n\t\ttree[ item.gen ].push( item );\n\t}\n\t/* eslint-enable */\n\treturn tree;\n}\n\nfunction processGeneration( generation, action ) {\n\tgeneration.map( store => {\n\t\tconst data = Object.assign( {\n\t\t\tdeps: _.pick( this.stores, store.waitFor ) // eslint-disable-line no-invalid-this\n\t\t}, action );\n\t\tdispatcherChannel.publish(\n\t\t\t`${ store.namespace }.handle.${ action.actionType }`,\n\t\t\tdata\n\t\t);\n\t} );\n}\n\nclass Dispatcher extends machina.BehavioralFsm {\n\tconstructor() {\n\t\tsuper( {\n\t\t\tinitialState: \"ready\",\n\t\t\tactionMap: {},\n\t\t\tstates: {\n\t\t\t\tready: {\n\t\t\t\t\t_onEnter() {\n\t\t\t\t\t\tthis.actionContext = undefined;\n\t\t\t\t\t},\n\t\t\t\t\t\"action.dispatch\": \"dispatching\"\n\t\t\t\t},\n\t\t\t\tdispatching: {\n\t\t\t\t\t_onEnter( luxAction ) {\n\t\t\t\t\t\tthis.actionContext = luxAction;\n\t\t\t\t\t\tif ( luxAction.generations.length ) {\n\t\t\t\t\t\t\tfor ( const generation of luxAction.generations ) {\n\t\t\t\t\t\t\t\tprocessGeneration.call( luxAction, generation, luxAction.action );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.transition( luxAction, \"notifying\" );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.transition( luxAction, \"nothandled\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"action.handled\"( luxAction, data ) {\n\t\t\t\t\t\tif ( data.hasChanged ) {\n\t\t\t\t\t\t\tluxAction.updated.push( data.namespace );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t_onExit( luxAction ) {\n\t\t\t\t\t\tif ( luxAction.updated.length ) {\n\t\t\t\t\t\t\tdispatcherChannel.publish( \"prenotify\", { stores: luxAction.updated } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnotifying: {\n\t\t\t\t\t_onEnter( luxAction ) {\n\t\t\t\t\t\tdispatcherChannel.publish( \"notify\", {\n\t\t\t\t\t\t\taction: luxAction.action\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnothandled: {}\n\t\t\t},\n\t\t\tgetStoresHandling( actionType ) {\n\t\t\t\tconst stores = this.actionMap[ actionType ] || [];\n\t\t\t\treturn {\n\t\t\t\t\tstores,\n\t\t\t\t\tgenerations: buildGenerations( stores, actionType )\n\t\t\t\t};\n\t\t\t}\n\t\t} );\n\t\tthis.createSubscribers();\n\t// eslint-enable object-shorthand\n\t}\n\n\thandleActionDispatch( data ) {\n\t\tconst luxAction = Object.assign(\n\t\t\t{ action: data, generationIndex: 0, updated: [] },\n\t\t\tthis.getStoresHandling( data.actionType )\n\t\t);\n\t\tthis.handle( luxAction, \"action.dispatch\" );\n\t}\n\n\tregisterStore( storeMeta ) {\n\t\tfor ( const actionDef of storeMeta.actions ) {\n\t\t\tconst actionName = actionDef.actionType;\n\t\t\tconst actionMeta = {\n\t\t\t\tnamespace: storeMeta.namespace,\n\t\t\t\twaitFor: actionDef.waitFor\n\t\t\t};\n\t\t\tconst action = this.actionMap[ actionName ] = this.actionMap[ actionName ] || [];\n\t\t\taction.push( actionMeta );\n\t\t}\n\t}\n\n\tremoveStore( namespace ) {\n\t\tfunction isThisNameSpace( meta ) {\n\t\t\treturn meta.namespace === namespace;\n\t\t}\n\t\t/*eslint-disable */\n\t\tfor ( let [ k, v ] of entries( this.actionMap ) ) {\n\t\t\tlet idx = v.findIndex( isThisNameSpace );\n\t\t\tif ( idx !== -1 ) {\n\t\t\t\tv.splice( idx, 1 );\n\t\t\t}\n\t\t}\n\t\t/* eslint-enable */\n\t}\n\n\tcreateSubscribers() {\n\t\tthis.__subscriptions = [\n\t\t\tactionChannel.subscribe(\n\t\t\t\t\"execute.*\",\n\t\t\t\tdata => this.handleActionDispatch( data )\n\t\t\t),\n\t\t\tdispatcherChannel.subscribe(\n\t\t\t\t\"*.handled.*\",\n\t\t\t\tdata => this.handle( this.actionContext, \"action.handled\", data )\n\t\t\t).constraint( () => !!this.actionContext )\n\t\t];\n\t}\n\n\tdispose() {\n\t\tif ( this.__subscriptions ) {\n\t\t\tthis.__subscriptions.forEach( subscription => subscription.unsubscribe() );\n\t\t\tthis.__subscriptions = null;\n\t\t}\n\t}\n}\n\nexport default new Dispatcher();\n\n","// **********************************************\n// *   Generalized Mixin Behavior for non-lux   *\n// **********************************************\n\nimport { storeMixin, storeReactMixin } from \"./store\";\nimport { actionCreatorMixin, actionCreatorReactMixin, dispatch } from \"./actionCreator\";\nimport { actionListenerMixin } from \"./actionListener\";\nimport luxWrapper from \"./luxWrapper\";\n\nfunction mixin( context, ...mixins ) {\n\tif ( mixins.length === 0 ) {\n\t\tmixins = [ storeMixin, actionCreatorMixin ];\n\t}\n\n\tmixins.forEach( mxn => {\n\t\tif ( typeof mxn === \"function\" ) {\n\t\t\tmxn = mxn();\n\t\t}\n\t\tif ( mxn.mixin ) {\n\t\t\tObject.assign( context, mxn.mixin );\n\t\t}\n\t\tif ( typeof mxn.setup !== \"function\" ) {\n\t\t\tthrow new Error( \"Lux mixins should have a setup method. Did you perhaps pass your mixins ahead of your target instance?\" );\n\t\t}\n\t\tmxn.setup.call( context );\n\t\tif ( mxn.teardown ) {\n\t\t\tcontext.__lux.cleanup.push( mxn.teardown );\n\t\t}\n\t} );\n\tcontext.luxCleanup = () => {\n\t\tcontext.__lux.cleanup.forEach( method => method.call( context ) );\n\t\tcontext.__lux.cleanup = undefined;\n\t\tdelete context.__lux.cleanup;\n\t};\n\treturn context;\n}\n\nmixin.store = storeMixin;\nmixin.actionCreator = actionCreatorMixin;\nmixin.actionListener = actionListenerMixin;\n\nconst reactMixin = {\n\tactionCreator: actionCreatorReactMixin,\n\tstore: storeReactMixin\n};\n\nfunction actionListener( target ) {\n\treturn mixin( target, actionListenerMixin );\n}\n\nfunction actionCreator( target ) {\n\treturn mixin( target, actionCreatorMixin );\n}\n\nfunction actionCreatorListener( target ) {\n\treturn actionCreator( actionListener( target ) );\n}\n\nexport {\n\tmixin,\n\treactMixin,\n\tactionListener,\n\tactionCreator,\n\tactionCreatorListener,\n\tdispatch,\n\tluxWrapper\n};\n","// *******************************************\n// *           Action Creator Mixin          *\n// *******************************************\n\nimport { entries } from \"../utils\";\nimport { getActionGroup, actions } from \"../actions\";\n\nexport function dispatch( action, ...args ) {\n\tif ( actions[ action ] ) {\n\t\tactions[ action ]( ...args );\n\t} else {\n\t\tthrow new Error( `There is no action named '${ action }'` );\n\t}\n}\n\nexport const actionCreatorMixin = {\n\tsetup() {\n\t\tthis.getActionGroup = this.getActionGroup || [];\n\t\tthis.getActions = this.getActions || [];\n\n\t\tif ( typeof this.getActions === \"string\" ) {\n\t\t\tthis.getActions = [ this.getActions ];\n\t\t}\n\n\t\tconst addActionIfNotPresent = ( k, v ) => {\n\t\t\tif ( !this[ k ] ) {\n\t\t\t\tthis[ k ] = v;\n\t\t\t}\n\t\t};\n\t\tthis.getActionGroup.forEach( group => {\n\t\t\tfor ( const [ k, v ] of entries( getActionGroup( group ) ) ) {\n\t\t\t\taddActionIfNotPresent( k, v );\n\t\t\t}\n\t\t} );\n\n\t\tif ( this.getActions.length ) {\n\t\t\tthis.getActions.forEach( function( key ) {\n\t\t\t\taddActionIfNotPresent( key, function() {\n\t\t\t\t\tdispatch( key, ...arguments );\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\t},\n\tmixin: { dispatch }\n};\n\nexport const actionCreatorReactMixin = {\n\tcomponentWillMount: actionCreatorMixin.setup,\n\tdispatch\n};\n","\n\n/* istanbul ignore next */\nif ( !( typeof global === \"undefined\" ? window : global )._babelPolyfill ) {\n\tthrow new Error( \"You must include the babel polyfill on your page before lux is loaded. See https://babeljs.io/docs/usage/polyfill/ for more details.\" );\n}\n\nimport utils from \"./utils\";\n\nimport {\n\tgetActionGroup,\n\tcustomActionCreator,\n\tactions\n} from \"./actions\";\n\nimport {\n\tmixin,\n\treactMixin,\n\tactionListener,\n\tactionCreator,\n\tactionCreatorListener,\n\tdispatch,\n\tluxWrapper\n} from \"./mixins\";\n\n/* istanbul ignore next */\nfunction publishAction( ...args ) {\n\t/* eslint-disable no-console */\n\tif ( console && typeof console.log === \"function\" ) {\n\t\tconsole.log( \"lux.publishAction has been deprecated and will be removed in future releases. Please use lux.dispatch.\" );\n\t}\n\t/* eslint-enable no-console */\n\tdispatch( ...args );\n}\n\nimport { Store, stores, removeStore } from \"./store\";\n\nimport dispatcher from \"./dispatcher\";\n\nexport default {\n\tactions,\n\tcustomActionCreator,\n\tdispatch,\n\tpublishAction,\n\tdispatcher,\n\tgetActionGroup,\n\tactionCreatorListener,\n\tactionCreator,\n\tactionListener,\n\tmixin,\n\treactMixin,\n\tremoveStore,\n\tStore,\n\tstores,\n\tutils,\n\tluxWrapper\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","// NOTE - these will eventually live in their own add-on lib or in a debug build of lux\n\n/* eslint  \"no-console\":\"off\" */\n\nimport { actions, getGroupsWithAction } from \"./actions\";\nimport dispatcher from \"./dispatcher\";\n\nexport function printActions() {\n\tconst actionList = Object.keys( actions )\n\t\t.map( function( x ) {\n\t\t\treturn {\n\t\t\t\t\"action name\": x,\n\t\t\t\tstores: dispatcher.getStoresHandling( x ).stores.map( function( s ) {\n\t\t\t\t\treturn s.namespace;\n\t\t\t\t} ).join( \",\" ),\n\t\t\t\tgroups: getGroupsWithAction( x ).join( \",\" )\n\t\t\t};\n\t\t} );\n\tif ( console && console.table ) {\n\t\tconsole.group( \"Currently Recognized Actions\" );\n\t\tconsole.table( actionList );\n\t\tconsole.groupEnd();\n\t} else if ( console && console.log ) {\n\t\tconsole.log( actionList );\n\t}\n}\n\nexport function printStoreDepTree( actionType ) {\n\tlet tree = [];\n\tactionType = typeof actionType === \"string\" ? [ actionType ] : actionType;\n\tif ( !actionType ) {\n\t\tactionType = Object.keys( actions );\n\t}\n\tactionType.forEach( function( at ) {\n\t\tdispatcher.getStoresHandling( at )\n\t\t\t.generations.forEach( function( x ) {\n\t\t\t\twhile ( x.length ) {\n\t\t\t\t\tconst t = x.pop();\n\t\t\t\t\ttree.push( {\n\t\t\t\t\t\t\"action type\": at,\n\t\t\t\t\t\t\"store namespace\": t.namespace,\n\t\t\t\t\t\t\"waits for\": t.waitFor.join( \",\" ),\n\t\t\t\t\t\tgeneration: t.gen\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\tif ( console && console.table ) {\n\t\t\tconsole.group( `Store Dependency List for ${ at }` );\n\t\t\tconsole.table( tree );\n\t\t\tconsole.groupEnd();\n\t\t} else if ( console && console.log ) {\n\t\t\tconsole.log( `Store Dependency List for ${ at }:` );\n\t\t\tconsole.log( tree );\n\t\t}\n\t\ttree = [];\n\t} );\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__10__;","module.exports = __WEBPACK_EXTERNAL_MODULE__11__;","// **********************************************\n// *                 Store Mixin                *\n// **********************************************\n\nimport { storeChannel, dispatcherChannel } from \"../bus\";\nimport { ensureLuxProp, entries } from \"../utils\";\n\nfunction gateKeeper( instance, store ) {\n\tconst payload = {};\n\tpayload[ store ] = true;\n\tconst __lux = instance.__lux;\n\n\tconst found = __lux.waitFor.indexOf( store );\n\n\tif ( found > -1 ) {\n\t\t__lux.waitFor.splice( found, 1 );\n\t\t__lux.heardFrom.push( payload );\n\n\t\tif ( __lux.waitFor.length === 0 ) {\n\t\t\t__lux.heardFrom = [];\n\t\t\tinstance.stores.onChange.call( instance, payload );\n\t\t}\n\t}\n}\n\nfunction handlePreNotify( instance, data ) {\n\tinstance.__lux.waitFor = data.stores.filter(\n\t\titem => instance.stores.listenTo.indexOf( item ) > -1\n\t);\n}\n\nexport const storeMixin = {\n\tsetup() {\n\t\tconst __lux = ensureLuxProp( this );\n\t\tconst stores = this.stores;\n\t\tif ( !stores ) {\n\t\t\tthrow new Error( \"Your component must provide a \\\"stores\\\" key\" );\n\t\t}\n\n\t\tif ( !stores.listenTo || !stores.listenTo.length ) {\n\t\t\tthrow new Error( \"listenTo must contain at least one store namespace\" );\n\t\t}\n\n\t\tconst listenTo = typeof stores.listenTo === \"string\" ? [ stores.listenTo ] : stores.listenTo;\n\n\t\tif ( !stores.onChange ) {\n\t\t\tthrow new Error( `A component was told to listen to the following store(s): ${ listenTo } but no onChange handler was implemented` );\n\t\t}\n\n\t\t__lux.waitFor = [];\n\t\t__lux.heardFrom = [];\n\n\t\tlistenTo.forEach( store => {\n\t\t\t__lux.subscriptions[ `${ store }.changed` ] = storeChannel.subscribe( `${ store }.changed`, () => gateKeeper( this, store ) );\n\t\t} );\n\n\t\t__lux.subscriptions.prenotify = dispatcherChannel.subscribe( \"prenotify\", data => handlePreNotify( this, data ) );\n\t},\n\tteardown() {\n\t\tfor ( const [ key, sub ] of entries( this.__lux.subscriptions ) ) {\n\t\t\tlet split;\n\t\t\t// eslint-disable-next-line no-cond-assign\n\t\t\tif ( key === \"prenotify\" || ( ( split = key.split( \".\" ) ) && split.pop() === \"changed\" ) ) {\n\t\t\t\tsub.unsubscribe();\n\t\t\t}\n\t\t}\n\t},\n\tmixin: {}\n};\n\nexport const storeReactMixin = {\n\tcomponentWillMount: storeMixin.setup,\n\tcomponentWillUnmount: storeMixin.teardown\n};\n\n","// **********************************************\n// *            Action Listener Mixin           *\n// **********************************************\n\nimport { actionChannel } from \"../bus\";\nimport { ensureLuxProp } from \"../utils\";\nimport { generateActionCreator, addToActionGroup } from \"../actions\";\n\nexport function actionListenerMixin( { handlers, handlerFn, context, channel, topic } = {} ) {\n\treturn {\n\t\tsetup() {\n\t\t\tcontext = context || this;\n\t\t\tconst __lux = ensureLuxProp( context );\n\t\t\tconst subs = __lux.subscriptions;\n\t\t\thandlers = handlers || context.handlers;\n\t\t\tchannel = channel || actionChannel;\n\t\t\ttopic = topic || \"execute.*\";\n\t\t\thandlerFn = handlerFn || ( data => {\n\t\t\t\tconst handler = handlers[ data.actionType ];\n\t\t\t\tif ( handler ) {\n\t\t\t\t\thandler.apply( context, data.actionArgs );\n\t\t\t\t}\n\t\t\t} );\n\t\t\tif ( !handlers || !Object.keys( handlers ).length ) {\n\t\t\t\tthrow new Error( \"You must have at least one action handler in the handlers property\" );\n\t\t\t} else if ( subs && subs.actionListener ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsubs.actionListener = channel.subscribe( topic, handlerFn ).context( context );\n\t\t\tconst handlerKeys = Object.keys( handlers );\n\t\t\tgenerateActionCreator( handlerKeys );\n\t\t\tif ( context.namespace ) {\n\t\t\t\taddToActionGroup( context.namespace, handlerKeys );\n\t\t\t}\n\t\t},\n\t\tteardown() {\n\t\t\tthis.__lux.subscriptions.actionListener.unsubscribe();\n\t\t}\n\t};\n}\n","// **********************************************\n// *   Generalized Mixin Behavior for non-lux   *\n// **********************************************\n\nimport React from \"react\";\nimport { setupStoreListener, setupActionMap } from \"./wrapperUtils\";\nimport { entries } from \"../utils\";\n\nexport default function luxWrapper( Component, {\n\tactions,\n\tstores,\n\tgetState,\n\tpureComponent = false,\n\tcomponentWillMount,\n\tcomponentDidMount,\n\tcomponentWillReceiveProps,\n\tcomponentWillUpdate,\n\tcomponentDidUpdate,\n\tcomponentWillUnmount\n} ) {\n\tfunction getComponentState( instance, props ) {\n\t\tconst initialPayload = ( stores || [] ).reduce( ( m, s ) => {\n\t\t\tm[ s ] = true;\n\t\t\treturn m;\n\t\t}, {} );\n\t\treturn getState( props, initialPayload );\n\t}\n\n\tclass LuxWrapper extends React[ pureComponent ? \"PureComponent\" : \"Component\" ] {\n\t\tconstructor( props, context ) {\n\t\t\tsuper( props, context );\n\t\t\tsetupStoreListener( this, { stores, getState } );\n\t\t\tsetupActionMap( this, { actions } );\n\t\t\tif ( getState ) {\n\t\t\t\tthis.state = getComponentState( this, props );\n\t\t\t}\n\t\t}\n\n\t\t// eslint-disable-next-line camelcase\n\t\tUNSAFE_componentWillMount( ...args ) {\n\t\t\tif ( componentWillMount ) {\n\t\t\t\tcomponentWillMount.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentDidMount( ...args ) {\n\t\t\tif ( componentDidMount ) {\n\t\t\t\tcomponentDidMount.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\t// eslint-disable-next-line camelcase\n\t\tUNSAFE_componentWillReceiveProps( ...args ) {\n\t\t\tif ( getState ) {\n\t\t\t\tthis.setState( getComponentState( this, ...args ) );\n\t\t\t}\n\t\t\tif ( componentWillReceiveProps ) {\n\t\t\t\tcomponentWillReceiveProps.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\t// eslint-disable-next-line camelcase\n\t\tUNSAFE_componentWillUpdate( ...args ) {\n\t\t\tif ( componentWillUpdate ) {\n\t\t\t\tcomponentWillUpdate.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentDidUpdate( ...args ) {\n\t\t\tif ( componentDidUpdate ) {\n\t\t\t\tcomponentDidUpdate.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentWillUnmount( ...args ) {\n\t\t\tif ( componentWillUnmount ) {\n\t\t\t\tcomponentWillUnmount.apply( this, args );\n\t\t\t}\n\t\t\tfor ( const [ key, sub ] of entries( this.__lux.subscriptions ) ) {\n\t\t\t\tlet split;\n\t\t\t\t// eslint-disable-next-line no-cond-assign\n\t\t\t\tif ( key === \"prenotify\" || ( ( split = key.split( \".\" ) ) && split.pop() === \"changed\" ) ) {\n\t\t\t\t\tsub.unsubscribe();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trender() {\n\t\t\treturn React.createElement(\n\t\t\t\tComponent,\n\t\t\t\tObject.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tthis.props,\n\t\t\t\t\tthis.propToAction,\n\t\t\t\t\tthis.state\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tLuxWrapper.displayName = `LuxWrapped(${ Component.displayName || \"Component\" })`;\n\n\treturn LuxWrapper;\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__15__;","// **********************************************\n// *   wrapper utilities                        *\n// **********************************************\n\nimport { ensureLuxProp, entries } from \"../utils\";\nimport { storeChannel, dispatcherChannel } from \"../bus\";\nimport { dispatch } from \"./actionCreator\";\nimport { isString, isFunction } from \"lodash\";\n\nexport function gateKeeper( instance, { getState }, store ) {\n\tconst payload = {};\n\tpayload[ store ] = true;\n\tconst __lux = instance.__lux;\n\n\tconst found = __lux.waitFor.indexOf( store );\n\n\tif ( found > -1 ) {\n\t\t__lux.waitFor.splice( found, 1 );\n\t\t__lux.heardFrom.push( payload );\n\n\t\tif ( __lux.waitFor.length === 0 ) {\n\t\t\t__lux.heardFrom = [];\n\t\t\tinstance.setState( getState( instance.props, payload ) );\n\t\t}\n\t}\n}\n\nexport function handlePreNotify( instance, stores, data ) {\n\tinstance.__lux.waitFor = data.stores.filter(\n\t\titem => stores.indexOf( item ) > -1\n\t);\n}\n\nexport function setupStoreListener( instance, { stores, getState } ) {\n\tconst __lux = ensureLuxProp( instance );\n\t__lux.waitFor = [];\n\t__lux.heardFrom = [];\n\n\tif ( stores && stores.length ) {\n\t\tstores.forEach( store => {\n\t\t\t__lux.subscriptions[ `${ store }.changed` ] = storeChannel.subscribe(\n\t\t\t\t`${ store }.changed`,\n\t\t\t\t() => gateKeeper( instance, { getState }, store )\n\t\t\t);\n\t\t} );\n\n\t\t__lux.subscriptions.prenotify = dispatcherChannel.subscribe(\n\t\t\t\"prenotify\",\n\t\t\tdata => handlePreNotify( instance, stores, data )\n\t\t);\n\t}\n}\n\nexport function isSyntheticEvent( e ) {\n\treturn e.hasOwnProperty( \"eventPhase\" ) &&\n\t\te.hasOwnProperty( \"nativeEvent\" ) &&\n\t\te.hasOwnProperty( \"target\" ) &&\n\t\te.hasOwnProperty( \"type\" );\n}\n\nexport function getDefaultActionCreator( action ) {\n\tif ( Object.prototype.toString.call( action ) === \"[object String]\" ) {\n\t\treturn function( e, ...args ) {\n\t\t\tif ( !isSyntheticEvent( e ) ) {\n\t\t\t\targs.unshift( e );\n\t\t\t}\n\t\t\tdispatch( action, ...args );\n\t\t};\n\t}\n\treturn undefined;\n}\n\nexport function setupActionMap( instance, { actions } ) {\n\tinstance.propToAction = {};\n\tfor ( const [ childProp, action ] of entries( actions || {} ) ) {\n\t\tlet actionCreator = action; // assumes function by default\n\t\tif ( isString( action ) ) {\n\t\t\tactionCreator = getDefaultActionCreator( action );\n\t\t} else if ( !isFunction( action ) ) {\n\t\t\tthrow new Error( \"The values provided to the luxWrapper actions parameter must be a string or a function\" );\n\t\t}\n\t\tinstance.propToAction[ childProp ] = actionCreator;\n\t}\n}\n","import { storeChannel, dispatcherChannel } from \"./bus\";\nimport { entries } from \"./utils\";\nimport dispatcher from \"./dispatcher\";\nimport _ from \"lodash\";\nimport { mixin } from \"./mixins\";\n\nexport const stores = {};\n\nfunction buildActionList( handlers ) {\n\tconst actionList = [];\n\tfor ( const [ key, handler ] of entries( handlers ) ) {\n\t\tactionList.push( {\n\t\t\tactionType: key,\n\t\t\twaitFor: handler.waitFor || []\n\t\t} );\n\t}\n\treturn actionList;\n}\n\nfunction ensureStoreOptions( options, handlers, store ) {\n\tconst namespace = ( options && options.namespace ) || store.namespace;\n\tif ( namespace in stores ) {\n\t\tthrow new Error( `The store namespace \"${ namespace }\" already exists.` );\n\t}\n\tif ( !namespace ) {\n\t\tthrow new Error( \"A lux store must have a namespace value provided\" );\n\t}\n\tif ( !handlers || !Object.keys( handlers ).length ) {\n\t\tthrow new Error( \"A lux store must have action handler methods provided\" );\n\t}\n}\n\nfunction getHandlerObject( key, listeners ) {\n\treturn {\n\t\twaitFor: [],\n\t\thandler() {\n\t\t\tlet changed = 0;\n\t\t\tconst args = Array.from( arguments );\n\t\t\tlisteners[ key ].forEach( function( listener ) {\n\t\t\t\tchanged += ( listener.apply( this, args ) === false ? 0 : 1 );\n\t\t\t}.bind( this ) );\n\t\t\treturn changed > 0;\n\t\t}\n\t};\n}\n\nfunction updateWaitFor( source, handlerObject ) {\n\tif ( source.waitFor ) {\n\t\tsource.waitFor.forEach( function( dep ) {\n\t\t\tif ( handlerObject.waitFor.indexOf( dep ) === -1 ) {\n\t\t\t\thandlerObject.waitFor.push( dep );\n\t\t\t}\n\t\t} );\n\t}\n}\n\nfunction addListeners( listeners, key, handler ) {\n\tlisteners[ key ] = listeners[ key ] || [];\n\tlisteners[ key ].push( handler.handler || handler );\n}\n\nfunction processStoreArgs( ...options ) {\n\tconst listeners = {};\n\tconst handlers = {};\n\tconst state = {};\n\tconst otherOpts = {};\n\toptions.forEach( function( o ) {\n\t\tlet opt;\n\t\tif ( o ) {\n\t\t\topt = _.clone( o );\n\t\t\t_.merge( state, opt.state );\n\t\t\tif ( opt.handlers ) {\n\t\t\t\tObject.keys( opt.handlers ).forEach( function( key ) {\n\t\t\t\t\tconst handler = opt.handlers[ key ];\n\t\t\t\t\t// set up the actual handler method that will be executed\n\t\t\t\t\t// as the store handles a dispatched action\n\t\t\t\t\thandlers[ key ] = handlers[ key ] || getHandlerObject( key, listeners );\n\t\t\t\t\t// ensure that the handler definition has a list of all stores\n\t\t\t\t\t// being waited upon\n\t\t\t\t\tupdateWaitFor( handler, handlers[ key ] );\n\t\t\t\t\t// Add the original handler method(s) to the listeners queue\n\t\t\t\t\taddListeners( listeners, key, handler );\n\t\t\t\t} );\n\t\t\t}\n\t\t\tdelete opt.handlers;\n\t\t\tdelete opt.state;\n\t\t\t_.merge( otherOpts, opt );\n\t\t}\n\t} );\n\treturn [ state, handlers, otherOpts ];\n}\n\nexport class Store {\n\tconstructor( ...opt ) {\n\t\tlet [ state, handlers, options ] = processStoreArgs( ...opt ); // eslint-disable-line prefer-const\n\t\tensureStoreOptions( options, handlers, this );\n\t\tconst namespace = options.namespace;\n\t\tObject.assign( this, options );\n\t\tstores[ namespace ] = this;\n\t\tlet inDispatch = false;\n\t\tthis.hasChanged = false;\n\n\t\tthis.getState = function() {\n\t\t\treturn state;\n\t\t};\n\n\t\tthis.setState = function( newState ) {\n\t\t\tif ( !inDispatch ) {\n\t\t\t\tthrow new Error( \"setState can only be called during a dispatch cycle from a store action handler.\" );\n\t\t\t}\n\t\t\tstate = Object.assign( state, newState );\n\t\t};\n\n\t\tthis.replaceState = function( newState ) {\n\t\t\tif ( !inDispatch ) {\n\t\t\t\tthrow new Error( \"replaceState can only be called during a dispatch cycle from a store action handler.\" );\n\t\t\t}\n\t\t\t// we preserve the underlying state ref, but clear it\n\t\t\tObject.keys( state ).forEach( function( key ) {\n\t\t\t\tdelete state[ key ];\n\t\t\t} );\n\t\t\tstate = Object.assign( state, newState );\n\t\t};\n\n\t\tthis.flush = function flush() {\n\t\t\tinDispatch = false;\n\t\t\tif ( this.hasChanged ) {\n\t\t\t\tthis.hasChanged = false;\n\t\t\t\tstoreChannel.publish( `${ this.namespace }.changed` );\n\t\t\t}\n\t\t};\n\n\t\tmixin( this, mixin.actionListener( {\n\t\t\tcontext: this,\n\t\t\tchannel: dispatcherChannel,\n\t\t\ttopic: `${ namespace }.handle.*`,\n\t\t\thandlers,\n\t\t\thandlerFn: function( data ) {\n\t\t\t\tif ( handlers.hasOwnProperty( data.actionType ) ) {\n\t\t\t\t\tinDispatch = true;\n\t\t\t\t\tconst res = handlers[ data.actionType ].handler.apply( this, data.actionArgs.concat( data.deps ) );\n\t\t\t\t\tthis.hasChanged = !( res === false );\n\t\t\t\t\tdispatcherChannel.publish(\n\t\t\t\t\t\t`${ this.namespace }.handled.${ data.actionType }`,\n\t\t\t\t\t\t{ hasChanged: this.hasChanged, namespace: this.namespace }\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}.bind( this )\n\t\t} ) );\n\n\t\tthis.__subscription = {\n\t\t\tnotify: dispatcherChannel.subscribe( \"notify\", () => this.flush() )\n\t\t\t\t.constraint( () => inDispatch )\n\t\t};\n\n\t\tdispatcher.registerStore(\n\t\t\t{\n\t\t\t\tnamespace,\n\t\t\t\tactions: buildActionList( handlers )\n\t\t\t}\n\t\t);\n\t}\n\n\t// Need to build in behavior to remove this store\n\t// from the dispatcher's actionMap as well!\n\tdispose() {\n\t\t/*eslint-disable */\n\t\tfor ( let [ k, subscription ] of entries( this.__subscription ) ) {\n\t\t\tsubscription.unsubscribe();\n\t\t}\n\t\t/* eslint-enable */\n\t\tdelete stores[ this.namespace ];\n\t\tdispatcher.removeStore( this.namespace );\n\t\tthis.luxCleanup();\n\t}\n}\n\nexport function removeStore( namespace ) {\n\tstores[ namespace ].dispose();\n}\n"],"sourceRoot":""}