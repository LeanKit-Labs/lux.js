{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 2e665799a2bbd51d0c02","webpack:///./src/lux.js","webpack:///./src/utils.js","webpack:///./src/printUtils.js","webpack:///./src/actions.js","webpack:///external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}","webpack:///./src/bus.js","webpack:///external \"postal\"","webpack:///./src/dispatcher.js","webpack:///external \"machina\"","webpack:///./src/mixins/index.js","webpack:///./src/mixins/store.js","webpack:///./src/mixins/actionCreator.js","webpack:///./src/mixins/actionListener.js","webpack:///./src/mixins/luxWrapper.js","webpack:///external {\"root\":\"React\",\"commonjs\":\"react\",\"commonjs2\":\"react\",\"amd\":\"react\"}","webpack:///./src/mixins/wrapperUtils.js","webpack:///./src/store.js"],"names":["global","window","_babelPolyfill","Error","publishAction","console","log","actions","customActionCreator","dispatch","dispatcher","getActionGroup","actionCreatorListener","actionCreator","actionListener","mixin","reactMixin","removeStore","Store","stores","utils","luxWrapper","ensureLuxProp","entries","context","__lux","cleanup","subscriptions","obj","indexOf","Object","keys","k","printActions","printStoreDepTree","actionList","map","x","getStoresHandling","s","namespace","join","groups","table","group","groupEnd","actionType","tree","forEach","at","generations","length","t","pop","push","waitFor","generation","gen","generateActionCreator","getGroupsWithAction","addToActionGroup","create","actionGroups","action","args","Array","from","arguments","publish","topic","data","actionArgs","pick","actionName","list","assign","groupName","diff","difference","actionChannel","channel","storeChannel","dispatcherChannel","postal","calculateGen","store","lookup","namespaces","calcdGen","_namespaces","dep","depStore","thisGen","warn","buildGenerations","key","item","processGeneration","deps","Dispatcher","initialState","actionMap","states","ready","_onEnter","actionContext","undefined","dispatching","luxAction","call","transition","hasChanged","updated","_onExit","notifying","nothandled","createSubscribers","generationIndex","handle","storeMeta","actionDef","actionMeta","isThisNameSpace","meta","v","idx","findIndex","splice","__subscriptions","subscribe","env","handleActionDispatch","constraint","subscription","unsubscribe","BehavioralFsm","mixins","mxn","setup","teardown","luxCleanup","method","target","gateKeeper","instance","payload","found","heardFrom","onChange","handlePreNotify","filter","listenTo","storeMixin","prenotify","sub","split","storeReactMixin","componentWillMount","componentWillUnmount","actionCreatorMixin","getActions","addActionIfNotPresent","actionCreatorReactMixin","actionListenerMixin","handlers","handlerFn","subs","handler","apply","handlerKeys","Component","getState","pureComponent","componentDidMount","componentWillReceiveProps","componentWillUpdate","componentDidUpdate","getStateTakesProps","getComponentState","props","initialPayload","reduce","m","LuxWrapper","state","setState","createElement","propToAction","displayName","setupStoreListener","isSyntheticEvent","getDefaultActionCreator","setupActionMap","e","hasOwnProperty","prototype","toString","unshift","childProp","buildActionList","ensureStoreOptions","options","getHandlerObject","listeners","changed","listener","bind","updateWaitFor","source","handlerObject","addListeners","processStoreArgs","otherOpts","o","opt","clone","merge","inDispatch","newState","replaceState","flush","res","concat","__subscription","notify","registerStore","dispose"],"mappings":"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","file":"lux.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"postal\"), require(\"machina\"), require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"postal\", \"machina\", \"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"lux\"] = factory(require(\"lodash\"), require(\"postal\"), require(\"machina\"), require(\"react\"));\n\telse\n\t\troot[\"lux\"] = factory(root[\"_\"], root[\"postal\"], root[\"machina\"], root[\"React\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_8__, __WEBPACK_EXTERNAL_MODULE_14__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./js/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2e665799a2bbd51d0c02\n **/","\n\n/* istanbul ignore next */\nif ( !( typeof global === \"undefined\" ? window : global )._babelPolyfill ) {\n\tthrow new Error( \"You must include the babel polyfill on your page before lux is loaded. See https://babeljs.io/docs/usage/polyfill/ for more details.\" );\n}\n\nimport utils from \"./utils\";\n\nimport {\n\tgetActionGroup,\n\tcustomActionCreator,\n\tactions\n} from \"./actions\";\n\nimport {\n\tmixin,\n\treactMixin,\n\tactionListener,\n\tactionCreator,\n\tactionCreatorListener,\n\tdispatch,\n\tluxWrapper\n} from \"./mixins\";\n\n/* istanbul ignore next */\nfunction publishAction( ...args ) {\n\t/* eslint-disable no-console */\n\tif ( console && typeof console.log === \"function\" ) {\n\t\tconsole.log( \"lux.publishAction has been deprecated and will be removed in future releases. Please use lux.dispatch.\" );\n\t}\n\t/* eslint-enable no-console */\n\tdispatch( ...args );\n}\n\nimport { Store, stores, removeStore } from \"./store\";\n\nimport dispatcher from \"./dispatcher\";\n\nexport default {\n\tactions,\n\tcustomActionCreator,\n\tdispatch,\n\tpublishAction,\n\tdispatcher,\n\tgetActionGroup,\n\tactionCreatorListener,\n\tactionCreator,\n\tactionListener,\n\tmixin,\n\treactMixin,\n\tremoveStore,\n\tStore,\n\tstores,\n\tutils,\n\tluxWrapper\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lux.js\n **/","import { printActions, printStoreDepTree } from \"./printUtils\";\n\nexport function ensureLuxProp( context ) {\n\tconst __lux = context.__lux = ( context.__lux || {} );\n\t/*eslint-disable */\n\tconst cleanup = __lux.cleanup = ( __lux.cleanup || [] );\n\tconst subscriptions = __lux.subscriptions = ( __lux.subscriptions || {} );\n\t/*eslint-enable */\n\treturn __lux;\n}\n\nexport function *entries( obj ) {\n\tif ( [ \"object\", \"function\" ].indexOf( typeof obj ) === -1 ) {\n\t\tobj = {};\n\t}\n\tfor ( const k of Object.keys( obj ) ) {\n\t\tyield [ k, obj[ k ] ];\n\t}\n}\n\nexport default { printActions, printStoreDepTree };\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils.js\n **/","// NOTE - these will eventually live in their own add-on lib or in a debug build of lux\n\n/* eslint  \"no-console\":\"off\" */\n\nimport { actions, getGroupsWithAction } from \"./actions\";\nimport dispatcher from \"./dispatcher\";\n\nexport function printActions() {\n\tconst actionList = Object.keys( actions )\n\t\t.map( function( x ) {\n\t\t\treturn {\n\t\t\t\t\"action name\": x,\n\t\t\t\tstores: dispatcher.getStoresHandling( x ).stores.map( function( s ) {\n\t\t\t\t\treturn s.namespace;\n\t\t\t\t} ).join( \",\" ),\n\t\t\t\tgroups: getGroupsWithAction( x ).join( \",\" )\n\t\t\t};\n\t\t} );\n\tif ( console && console.table ) {\n\t\tconsole.group( \"Currently Recognized Actions\" );\n\t\tconsole.table( actionList );\n\t\tconsole.groupEnd();\n\t} else if ( console && console.log ) {\n\t\tconsole.log( actionList );\n\t}\n}\n\nexport function printStoreDepTree( actionType ) {\n\tlet tree = [];\n\tactionType = typeof actionType === \"string\" ? [ actionType ] : actionType;\n\tif ( !actionType ) {\n\t\tactionType = Object.keys( actions );\n\t}\n\tactionType.forEach( function( at ) {\n\t\tdispatcher.getStoresHandling( at )\n\t\t\t.generations.forEach( function( x ) {\n\t\t\t\twhile ( x.length ) {\n\t\t\t\t\tconst t = x.pop();\n\t\t\t\t\ttree.push( {\n\t\t\t\t\t\t\"action type\": at,\n\t\t\t\t\t\t\"store namespace\": t.namespace,\n\t\t\t\t\t\t\"waits for\": t.waitFor.join( \",\" ),\n\t\t\t\t\t\tgeneration: t.gen\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\tif ( console && console.table ) {\n\t\t\tconsole.group( `Store Dependency List for ${at}` );\n\t\t\tconsole.table( tree );\n\t\t\tconsole.groupEnd();\n\t\t} else if ( console && console.log ) {\n\t\t\tconsole.log( `Store Dependency List for ${at}:` );\n\t\t\tconsole.log( tree );\n\t\t}\n\t\ttree = [];\n\t} );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/printUtils.js\n **/","import _ from \"lodash\";\nimport { entries } from \"./utils\";\nimport { actionChannel } from \"./bus\";\nexport const actions = Object.create( null );\nexport const actionGroups = Object.create( null );\n\nexport function generateActionCreator( actionList ) {\n\tactionList.forEach( function( action ) {\n\t\tif ( !actions[ action ] ) {\n\t\t\tactions[ action ] = function() {\n\t\t\t\tconst args = Array.from( arguments );\n\t\t\t\tactionChannel.publish( {\n\t\t\t\t\ttopic: `execute.${action}`,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tactionType: action,\n\t\t\t\t\t\tactionArgs: args\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\t\t}\n\t} );\n}\n\n// This method is deprecated, but will remain as\n// long as the print utils need it.\n/* istanbul ignore next */\nexport function getActionGroup( group ) {\n\tif ( actionGroups[ group ] ) {\n\t\treturn _.pick( actions, actionGroups[ group ] );\n\t}\n\tthrow new Error( `There is no action group named '${group}'` );\n}\n\n// This method is deprecated, but will remain as\n// long as the print utils need it.\n/* istanbul ignore next */\nexport function getGroupsWithAction( actionName ) {\n\tconst groups = [];\n\tfor ( const [ group, list ] of entries( actionGroups ) ) {\n\t\tif ( list.indexOf( actionName ) >= 0 ) {\n\t\t\tgroups.push( group );\n\t\t}\n\t}\n\treturn groups;\n}\n\nexport function customActionCreator( action ) {\n\tObject.assign( actions, action );\n}\n\n// This method is deprecated, but will remain as\n// long as the print utils need it.\n/* istanbul ignore next */\nexport function addToActionGroup( groupName, actionList ) {\n\tlet group = actionGroups[ groupName ];\n\tif ( !group ) {\n\t\tgroup = actionGroups[ groupName ] = [];\n\t}\n\tactionList = typeof actionList === \"string\" ? [ actionList ] : actionList;\n\tconst diff = _.difference( actionList, Object.keys( actions ) );\n\tif ( diff.length ) {\n\t\tthrow new Error( `The following actions do not exist: ${diff.join( \", \" )}` );\n\t}\n\tactionList.forEach( function( action ) {\n\t\tif ( group.indexOf( action ) === -1 ) {\n\t\t\tgroup.push( action );\n\t\t}\n\t} );\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/actions.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"_\",\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\"}\n ** module id = 4\n ** module chunks = 0 1\n **/","import postal from \"postal\";\n\nconst actionChannel = postal.channel( \"lux.action\" );\nconst storeChannel = postal.channel( \"lux.store\" );\nconst dispatcherChannel = postal.channel( \"lux.dispatcher\" );\n\nexport {\n\tactionChannel,\n\tstoreChannel,\n\tdispatcherChannel,\n\tpostal\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/bus.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"postal\"\n ** module id = 6\n ** module chunks = 0 1\n **/","\nimport _ from \"lodash\";\nimport { dispatcherChannel, actionChannel } from \"./bus\";\nimport { entries } from \"./utils\";\nimport machina from \"machina\";\n\nfunction calculateGen( store, lookup, gen, actionType, namespaces ) {\n\tlet calcdGen = gen;\n\tconst _namespaces = namespaces || [];\n\tif ( _namespaces.indexOf( store.namespace ) > -1 ) {\n\t\tthrow new Error( `Circular dependency detected for the \"${store.namespace}\" store when participating in the \"${actionType}\" action.` );\n\t}\n\tif ( store.waitFor && store.waitFor.length ) {\n\t\tstore.waitFor.forEach( function( dep ) {\n\t\t\tconst depStore = lookup[ dep ];\n\t\t\tif ( depStore ) {\n\t\t\t\t_namespaces.push( store.namespace );\n\t\t\t\tconst thisGen = calculateGen( depStore, lookup, gen + 1, actionType, _namespaces );\n\t\t\t\tif ( thisGen > calcdGen ) {\n\t\t\t\t\tcalcdGen = thisGen;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// eslint-disable-next-line\n\t\t\t\tconsole.warn( `The \"${actionType}\" action in the \"${store.namespace}\" store waits for \"${dep}\" but a store with that namespace does not participate in this action.` );\n\t\t\t}\n\t\t} );\n\t}\n\treturn calcdGen;\n}\n\nfunction buildGenerations( stores, actionType ) {\n\tconst tree = [];\n\tconst lookup = {};\n\t/*eslint-disable */\n\tstores.forEach( store => lookup[ store.namespace ] = store );\n\tstores.forEach( store => store.gen = calculateGen( store, lookup, 0, actionType ) );\n\tfor ( let [ key, item ] of entries( lookup ) ) {\n\t\ttree[ item.gen ] = tree[ item.gen ] || [];\n\t\ttree[ item.gen ].push( item );\n\t}\n\t/*eslint-enable */\n\treturn tree;\n}\n\nfunction processGeneration( generation, action ) {\n\tgeneration.map( store => {\n\t\tconst data = Object.assign( {\n\t\t\tdeps: _.pick( this.stores, store.waitFor ) // eslint-disable-line no-invalid-this\n\t\t}, action );\n\t\tdispatcherChannel.publish(\n\t\t\t`${store.namespace}.handle.${action.actionType}`,\n\t\t\tdata\n\t\t);\n\t} );\n}\n\nclass Dispatcher extends machina.BehavioralFsm {\n\tconstructor() {\n\t\tsuper( {\n\t\t\tinitialState: \"ready\",\n\t\t\tactionMap: {},\n\t\t\tstates: {\n\t\t\t\tready: {\n\t\t\t\t\t_onEnter() {\n\t\t\t\t\t\tthis.actionContext = undefined;\n\t\t\t\t\t},\n\t\t\t\t\t\"action.dispatch\": \"dispatching\"\n\t\t\t\t},\n\t\t\t\tdispatching: {\n\t\t\t\t\t_onEnter( luxAction ) {\n\t\t\t\t\t\tthis.actionContext = luxAction;\n\t\t\t\t\t\tif ( luxAction.generations.length ) {\n\t\t\t\t\t\t\tfor ( const generation of luxAction.generations ) {\n\t\t\t\t\t\t\t\tprocessGeneration.call( luxAction, generation, luxAction.action );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.transition( luxAction, \"notifying\" );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.transition( luxAction, \"nothandled\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t\"action.handled\"( luxAction, data ) {\n\t\t\t\t\t\tif ( data.hasChanged ) {\n\t\t\t\t\t\t\tluxAction.updated.push( data.namespace );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t_onExit( luxAction ) {\n\t\t\t\t\t\tif ( luxAction.updated.length ) {\n\t\t\t\t\t\t\tdispatcherChannel.publish( \"prenotify\", { stores: luxAction.updated } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnotifying: {\n\t\t\t\t\t_onEnter( luxAction ) {\n\t\t\t\t\t\tdispatcherChannel.publish( \"notify\", {\n\t\t\t\t\t\t\taction: luxAction.action\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tnothandled: {}\n\t\t\t},\n\t\t\tgetStoresHandling( actionType ) {\n\t\t\t\tconst stores = this.actionMap[ actionType ] || [];\n\t\t\t\treturn {\n\t\t\t\t\tstores,\n\t\t\t\t\tgenerations: buildGenerations( stores, actionType )\n\t\t\t\t};\n\t\t\t}\n\t\t} );\n\t\tthis.createSubscribers();\n\t// eslint-enable object-shorthand\n\t}\n\n\thandleActionDispatch( data ) {\n\t\tconst luxAction = Object.assign(\n\t\t\t{ action: data, generationIndex: 0, updated: [] },\n\t\t\tthis.getStoresHandling( data.actionType )\n\t\t);\n\t\tthis.handle( luxAction, \"action.dispatch\" );\n\t}\n\n\tregisterStore( storeMeta ) {\n\t\tfor ( const actionDef of storeMeta.actions ) {\n\t\t\tconst actionName = actionDef.actionType;\n\t\t\tconst actionMeta = {\n\t\t\t\tnamespace: storeMeta.namespace,\n\t\t\t\twaitFor: actionDef.waitFor\n\t\t\t};\n\t\t\tconst action = this.actionMap[ actionName ] = this.actionMap[ actionName ] || [];\n\t\t\taction.push( actionMeta );\n\t\t}\n\t}\n\n\tremoveStore( namespace ) {\n\t\tfunction isThisNameSpace( meta ) {\n\t\t\treturn meta.namespace === namespace;\n\t\t}\n\t\t/*eslint-disable */\n\t\tfor ( let [ k, v ] of entries( this.actionMap ) ) {\n\t\t\tlet idx = v.findIndex( isThisNameSpace );\n\t\t\tif ( idx !== -1 ) {\n\t\t\t\tv.splice( idx, 1 );\n\t\t\t}\n\t\t}\n\t\t/*eslint-enable */\n\t}\n\n\tcreateSubscribers() {\n\t\tthis.__subscriptions = [\n\t\t\tactionChannel.subscribe(\n\t\t\t\t\"execute.*\",\n\t\t\t\t( data, env ) => this.handleActionDispatch( data )\n\t\t\t),\n\t\t\tdispatcherChannel.subscribe(\n\t\t\t\t\"*.handled.*\",\n\t\t\t\tdata => this.handle( this.actionContext, \"action.handled\", data )\n\t\t\t).constraint( () => !!this.actionContext )\n\t\t];\n\t}\n\n\tdispose() {\n\t\tif ( this.__subscriptions ) {\n\t\t\tthis.__subscriptions.forEach( subscription => subscription.unsubscribe() );\n\t\t\tthis.__subscriptions = null;\n\t\t}\n\t}\n}\n\nexport default new Dispatcher();\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/dispatcher.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_8__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"machina\"\n ** module id = 8\n ** module chunks = 0 1\n **/","// **********************************************\n// *   Generalized Mixin Behavior for non-lux   *\n// **********************************************\n\nimport { storeMixin, storeReactMixin } from \"./store\";\nimport { actionCreatorMixin, actionCreatorReactMixin, dispatch } from \"./actionCreator\";\nimport { actionListenerMixin } from \"./actionListener\";\nimport luxWrapper from \"./luxWrapper\";\n\nfunction mixin( context, ...mixins ) {\n\tif ( mixins.length === 0 ) {\n\t\tmixins = [ storeMixin, actionCreatorMixin ];\n\t}\n\n\tmixins.forEach( mxn => {\n\t\tif ( typeof mxn === \"function\" ) {\n\t\t\tmxn = mxn();\n\t\t}\n\t\tif ( mxn.mixin ) {\n\t\t\tObject.assign( context, mxn.mixin );\n\t\t}\n\t\tif ( typeof mxn.setup !== \"function\" ) {\n\t\t\tthrow new Error( \"Lux mixins should have a setup method. Did you perhaps pass your mixins ahead of your target instance?\" );\n\t\t}\n\t\tmxn.setup.call( context );\n\t\tif ( mxn.teardown ) {\n\t\t\tcontext.__lux.cleanup.push( mxn.teardown );\n\t\t}\n\t} );\n\tcontext.luxCleanup = () => {\n\t\tcontext.__lux.cleanup.forEach( method => method.call( context ) );\n\t\tcontext.__lux.cleanup = undefined;\n\t\tdelete context.__lux.cleanup;\n\t};\n\treturn context;\n}\n\nmixin.store = storeMixin;\nmixin.actionCreator = actionCreatorMixin;\nmixin.actionListener = actionListenerMixin;\n\nconst reactMixin = {\n\tactionCreator: actionCreatorReactMixin,\n\tstore: storeReactMixin\n};\n\nfunction actionListener( target ) {\n\treturn mixin( target, actionListenerMixin );\n}\n\nfunction actionCreator( target ) {\n\treturn mixin( target, actionCreatorMixin );\n}\n\nfunction actionCreatorListener( target ) {\n\treturn actionCreator( actionListener( target ) );\n}\n\nexport {\n\tmixin,\n\treactMixin,\n\tactionListener,\n\tactionCreator,\n\tactionCreatorListener,\n\tdispatch,\n\tluxWrapper\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/mixins/index.js\n **/","// **********************************************\n// *                 Store Mixin                *\n// **********************************************\n\nimport { storeChannel, dispatcherChannel } from \"../bus\";\nimport { ensureLuxProp, entries } from \"../utils\";\n\nfunction gateKeeper( instance, store, data ) {\n\tconst payload = {};\n\tpayload[ store ] = true;\n\tconst __lux = instance.__lux;\n\n\tconst found = __lux.waitFor.indexOf( store );\n\n\tif ( found > -1 ) {\n\t\t__lux.waitFor.splice( found, 1 );\n\t\t__lux.heardFrom.push( payload );\n\n\t\tif ( __lux.waitFor.length === 0 ) {\n\t\t\t__lux.heardFrom = [];\n\t\t\tinstance.stores.onChange.call( instance, payload );\n\t\t}\n\t}\n}\n\nfunction handlePreNotify( instance, data ) {\n\tinstance.__lux.waitFor = data.stores.filter(\n\t\titem => instance.stores.listenTo.indexOf( item ) > -1\n\t);\n}\n\nexport const storeMixin = {\n\tsetup() {\n\t\tconst __lux = ensureLuxProp( this );\n\t\tconst stores = this.stores;\n\t\tif ( !stores ) {\n\t\t\tthrow new Error( \"Your component must provide a \\\"stores\\\" key\" );\n\t\t}\n\n\t\tif ( !stores.listenTo || !stores.listenTo.length ) {\n\t\t\tthrow new Error( \"listenTo must contain at least one store namespace\" );\n\t\t}\n\n\t\tconst listenTo = typeof stores.listenTo === \"string\" ? [ stores.listenTo ] : stores.listenTo;\n\n\t\tif ( !stores.onChange ) {\n\t\t\tthrow new Error( `A component was told to listen to the following store(s): ${listenTo} but no onChange handler was implemented` );\n\t\t}\n\n\t\t__lux.waitFor = [];\n\t\t__lux.heardFrom = [];\n\n\t\tlistenTo.forEach( store => {\n\t\t\t__lux.subscriptions[ `${store}.changed` ] = storeChannel.subscribe( `${store}.changed`, () => gateKeeper( this, store ) );\n\t\t} );\n\n\t\t__lux.subscriptions.prenotify = dispatcherChannel.subscribe( \"prenotify\", data => handlePreNotify( this, data ) );\n\t},\n\tteardown() {\n\t\tfor ( const [ key, sub ] of entries( this.__lux.subscriptions ) ) {\n\t\t\tlet split;\n\t\t\t// eslint-disable-next-line no-cond-assign\n\t\t\tif ( key === \"prenotify\" || ( ( split = key.split( \".\" ) ) && split.pop() === \"changed\" ) ) {\n\t\t\t\tsub.unsubscribe();\n\t\t\t}\n\t\t}\n\t},\n\tmixin: {}\n};\n\nexport const storeReactMixin = {\n\tcomponentWillMount: storeMixin.setup,\n\tcomponentWillUnmount: storeMixin.teardown\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/mixins/store.js\n **/","// *******************************************\n// *           Action Creator Mixin          *\n// *******************************************\n\nimport { entries } from \"../utils\";\nimport { getActionGroup, actions } from \"../actions\";\n\nexport function dispatch( action, ...args ) {\n\tif ( actions[ action ] ) {\n\t\tactions[ action ]( ...args );\n\t} else {\n\t\tthrow new Error( `There is no action named '${action}'` );\n\t}\n}\n\nexport const actionCreatorMixin = {\n\tsetup() {\n\t\tthis.getActionGroup = this.getActionGroup || [];\n\t\tthis.getActions = this.getActions || [];\n\n\t\tif ( typeof this.getActions === \"string\" ) {\n\t\t\tthis.getActions = [ this.getActions ];\n\t\t}\n\n\t\tconst addActionIfNotPresent = ( k, v ) => {\n\t\t\tif ( !this[ k ] ) {\n\t\t\t\tthis[ k ] = v;\n\t\t\t}\n\t\t};\n\t\tthis.getActionGroup.forEach( group => {\n\t\t\tfor ( const [ k, v ] of entries( getActionGroup( group ) ) ) {\n\t\t\t\taddActionIfNotPresent( k, v );\n\t\t\t}\n\t\t} );\n\n\t\tif ( this.getActions.length ) {\n\t\t\tthis.getActions.forEach( function( key ) {\n\t\t\t\taddActionIfNotPresent( key, function() {\n\t\t\t\t\tdispatch( key, ...arguments );\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\t},\n\tmixin: { dispatch }\n};\n\nexport const actionCreatorReactMixin = {\n\tcomponentWillMount: actionCreatorMixin.setup,\n\tdispatch\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/mixins/actionCreator.js\n **/","// **********************************************\n// *            Action Listener Mixin           *\n// **********************************************\n\nimport { actionChannel } from \"../bus\";\nimport { ensureLuxProp } from \"../utils\";\nimport { generateActionCreator, addToActionGroup } from \"../actions\";\n\nexport function actionListenerMixin( { handlers, handlerFn, context, channel, topic } = {} ) {\n\treturn {\n\t\tsetup() {\n\t\t\tcontext = context || this;\n\t\t\tconst __lux = ensureLuxProp( context );\n\t\t\tconst subs = __lux.subscriptions;\n\t\t\thandlers = handlers || context.handlers;\n\t\t\tchannel = channel || actionChannel;\n\t\t\ttopic = topic || \"execute.*\";\n\t\t\thandlerFn = handlerFn || ( ( data, env ) => {\n\t\t\t\tconst handler = handlers[ data.actionType ];\n\t\t\t\tif ( handler ) {\n\t\t\t\t\thandler.apply( context, data.actionArgs );\n\t\t\t\t}\n\t\t\t} );\n\t\t\tif ( !handlers || !Object.keys( handlers ).length ) {\n\t\t\t\tthrow new Error( \"You must have at least one action handler in the handlers property\" );\n\t\t\t} else if ( subs && subs.actionListener ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsubs.actionListener = channel.subscribe( topic, handlerFn ).context( context );\n\t\t\tconst handlerKeys = Object.keys( handlers );\n\t\t\tgenerateActionCreator( handlerKeys );\n\t\t\tif ( context.namespace ) {\n\t\t\t\taddToActionGroup( context.namespace, handlerKeys );\n\t\t\t}\n\t\t},\n\t\tteardown() {\n\t\t\tthis.__lux.subscriptions.actionListener.unsubscribe();\n\t\t}\n\t};\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/mixins/actionListener.js\n **/","// **********************************************\n// *   Generalized Mixin Behavior for non-lux   *\n// **********************************************\n\nimport React from \"react\";\nimport { setupStoreListener, setupActionMap } from \"./wrapperUtils\";\nimport { entries } from \"../utils\";\n\nexport default function luxWrapper( Component, {\n\tactions,\n\tstores,\n\tgetState,\n\tpureComponent = false,\n\tcomponentWillMount,\n\tcomponentDidMount,\n\tcomponentWillReceiveProps,\n\tcomponentWillUpdate,\n\tcomponentDidUpdate,\n\tcomponentWillUnmount\n} ) {\n\tconst getStateTakesProps = getState && getState.length;\n\n\tfunction getComponentState( instance, props ) {\n\t\tconst initialPayload = ( stores || [] ).reduce( ( m, s ) => {\n\t\t\tm[ s ] = true;\n\t\t\treturn m;\n\t\t}, {} );\n\t\treturn getState( props, initialPayload );\n\t}\n\n\tclass LuxWrapper extends React[ pureComponent ? \"PureComponent\" : \"Component\" ] {\n\t\tconstructor( props, context ) {\n\t\t\tsuper( props, context );\n\t\t\tsetupStoreListener( this, { stores, getState } );\n\t\t\tsetupActionMap( this, { actions } );\n\t\t\tif ( getState ) {\n\t\t\t\tthis.state = getComponentState( this, props );\n\t\t\t}\n\t\t}\n\n\t\tcomponentWillMount( ...args ) {\n\t\t\tif ( componentWillMount ) {\n\t\t\t\tcomponentWillMount.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentDidMount( ...args ) {\n\t\t\tif ( componentDidMount ) {\n\t\t\t\tcomponentDidMount.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentWillReceiveProps( ...args ) {\n\t\t\tif ( getState && getStateTakesProps ) {\n\t\t\t\tthis.setState( getComponentState( this, ...args ) );\n\t\t\t}\n\t\t\tif ( componentWillReceiveProps ) {\n\t\t\t\tcomponentWillReceiveProps.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentWillUpdate( ...args ) {\n\t\t\tif ( componentWillUpdate ) {\n\t\t\t\tcomponentWillUpdate.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentDidUpdate( ...args ) {\n\t\t\tif ( componentDidUpdate ) {\n\t\t\t\tcomponentDidUpdate.apply( this, args );\n\t\t\t}\n\t\t}\n\n\t\tcomponentWillUnmount( ...args ) {\n\t\t\tif ( componentWillUnmount ) {\n\t\t\t\tcomponentWillUnmount.apply( this, args );\n\t\t\t}\n\t\t\tfor ( const [ key, sub ] of entries( this.__lux.subscriptions ) ) {\n\t\t\t\tlet split;\n\t\t\t\t// eslint-disable-next-line no-cond-assign\n\t\t\t\tif ( key === \"prenotify\" || ( ( split = key.split( \".\" ) ) && split.pop() === \"changed\" ) ) {\n\t\t\t\t\tsub.unsubscribe();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trender() {\n\t\t\treturn React.createElement(\n\t\t\t\tComponent,\n\t\t\t\tObject.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tthis.props,\n\t\t\t\t\tthis.propToAction,\n\t\t\t\t\tthis.state\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tLuxWrapper.displayName = `LuxWrapped(${ Component.displayName || \"Component\" })`;\n\n\treturn LuxWrapper;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/mixins/luxWrapper.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_14__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"React\",\"commonjs\":\"react\",\"commonjs2\":\"react\",\"amd\":\"react\"}\n ** module id = 14\n ** module chunks = 0 1\n **/","// **********************************************\n// *   wrapper utilities                        *\n// **********************************************\n\nimport { ensureLuxProp, entries } from \"../utils\";\nimport { storeChannel, dispatcherChannel } from \"../bus\";\nimport { dispatch } from \"./actionCreator\";\nimport { isString, isFunction } from \"lodash\";\n\nexport function gateKeeper( instance, { getState }, store ) {\n\tconst payload = {};\n\tpayload[ store ] = true;\n\tconst __lux = instance.__lux;\n\n\tconst found = __lux.waitFor.indexOf( store );\n\n\tif ( found > -1 ) {\n\t\t__lux.waitFor.splice( found, 1 );\n\t\t__lux.heardFrom.push( payload );\n\n\t\tif ( __lux.waitFor.length === 0 ) {\n\t\t\t__lux.heardFrom = [];\n\t\t\tinstance.setState( getState( instance.props, payload ) );\n\t\t}\n\t}\n}\n\nexport function handlePreNotify( instance, stores, data ) {\n\tinstance.__lux.waitFor = data.stores.filter(\n\t\titem => stores.indexOf( item ) > -1\n\t);\n}\n\nexport function setupStoreListener( instance, { stores, getState } ) {\n\tconst __lux = ensureLuxProp( instance );\n\t__lux.waitFor = [];\n\t__lux.heardFrom = [];\n\n\tif ( stores && stores.length ) {\n\t\tstores.forEach( store => {\n\t\t\t__lux.subscriptions[ `${ store }.changed` ] = storeChannel.subscribe(\n\t\t\t\t`${ store }.changed`,\n\t\t\t\t() => gateKeeper( instance, { getState }, store )\n\t\t\t);\n\t\t} );\n\n\t\t__lux.subscriptions.prenotify = dispatcherChannel.subscribe(\n\t\t\t\"prenotify\",\n\t\t\tdata => handlePreNotify( instance, stores, data )\n\t\t);\n\t}\n}\n\nexport function isSyntheticEvent( e ) {\n\treturn e.hasOwnProperty( \"eventPhase\" ) &&\n\t\te.hasOwnProperty( \"nativeEvent\" ) &&\n\t\te.hasOwnProperty( \"target\" ) &&\n\t\te.hasOwnProperty( \"type\" );\n}\n\nexport function getDefaultActionCreator( action ) {\n\tif ( Object.prototype.toString.call( action ) === \"[object String]\" ) {\n\t\treturn function( e, ...args ) {\n\t\t\tif ( !isSyntheticEvent( e ) ) {\n\t\t\t\targs.unshift( e );\n\t\t\t}\n\t\t\tdispatch( action, ...args );\n\t\t};\n\t}\n\treturn undefined;\n}\n\nexport function setupActionMap( instance, { actions } ) {\n\tinstance.propToAction = {};\n\tfor ( const [ childProp, action ] of entries( actions || {} ) ) {\n\t\tlet actionCreator = action; // assumes function by default\n\t\tif ( isString( action ) ) {\n\t\t\tactionCreator = getDefaultActionCreator( action );\n\t\t} else if ( !isFunction( action ) ) {\n\t\t\tthrow new Error( \"The values provided to the luxWrapper actions parameter must be a string or a function\" );\n\t\t}\n\t\tinstance.propToAction[ childProp ] = actionCreator;\n\t}\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/mixins/wrapperUtils.js\n **/","import { storeChannel, dispatcherChannel } from \"./bus\";\nimport { entries } from \"./utils\";\nimport dispatcher from \"./dispatcher\";\nimport _ from \"lodash\";\nimport { mixin } from \"./mixins\";\n\nexport const stores = {};\n\nfunction buildActionList( handlers ) {\n\tconst actionList = [];\n\tfor ( const [ key, handler ] of entries( handlers ) ) {\n\t\tactionList.push( {\n\t\t\tactionType: key,\n\t\t\twaitFor: handler.waitFor || []\n\t\t} );\n\t}\n\treturn actionList;\n}\n\nfunction ensureStoreOptions( options, handlers, store ) {\n\tconst namespace = ( options && options.namespace ) || store.namespace;\n\tif ( namespace in stores ) {\n\t\tthrow new Error( `The store namespace \"${namespace}\" already exists.` );\n\t}\n\tif ( !namespace ) {\n\t\tthrow new Error( \"A lux store must have a namespace value provided\" );\n\t}\n\tif ( !handlers || !Object.keys( handlers ).length ) {\n\t\tthrow new Error( \"A lux store must have action handler methods provided\" );\n\t}\n}\n\nfunction getHandlerObject( key, listeners ) {\n\treturn {\n\t\twaitFor: [],\n\t\thandler() {\n\t\t\tlet changed = 0;\n\t\t\tconst args = Array.from( arguments );\n\t\t\tlisteners[ key ].forEach( function( listener ) {\n\t\t\t\tchanged += ( listener.apply( this, args ) === false ? 0 : 1 );\n\t\t\t}.bind( this ) );\n\t\t\treturn changed > 0;\n\t\t}\n\t};\n}\n\nfunction updateWaitFor( source, handlerObject ) {\n\tif ( source.waitFor ) {\n\t\tsource.waitFor.forEach( function( dep ) {\n\t\t\tif ( handlerObject.waitFor.indexOf( dep ) === -1 ) {\n\t\t\t\thandlerObject.waitFor.push( dep );\n\t\t\t}\n\t\t} );\n\t}\n}\n\nfunction addListeners( listeners, key, handler ) {\n\tlisteners[ key ] = listeners[ key ] || [];\n\tlisteners[ key ].push( handler.handler || handler );\n}\n\nfunction processStoreArgs( ...options ) {\n\tconst listeners = {};\n\tconst handlers = {};\n\tconst state = {};\n\tconst otherOpts = {};\n\toptions.forEach( function( o ) {\n\t\tlet opt;\n\t\tif ( o ) {\n\t\t\topt = _.clone( o );\n\t\t\t_.merge( state, opt.state );\n\t\t\tif ( opt.handlers ) {\n\t\t\t\tObject.keys( opt.handlers ).forEach( function( key ) {\n\t\t\t\t\tconst handler = opt.handlers[ key ];\n\t\t\t\t\t// set up the actual handler method that will be executed\n\t\t\t\t\t// as the store handles a dispatched action\n\t\t\t\t\thandlers[ key ] = handlers[ key ] || getHandlerObject( key, listeners );\n\t\t\t\t\t// ensure that the handler definition has a list of all stores\n\t\t\t\t\t// being waited upon\n\t\t\t\t\tupdateWaitFor( handler, handlers[ key ] );\n\t\t\t\t\t// Add the original handler method(s) to the listeners queue\n\t\t\t\t\taddListeners( listeners, key, handler );\n\t\t\t\t} );\n\t\t\t}\n\t\t\tdelete opt.handlers;\n\t\t\tdelete opt.state;\n\t\t\t_.merge( otherOpts, opt );\n\t\t}\n\t} );\n\treturn [ state, handlers, otherOpts ];\n}\n\nexport class Store {\n\n\tconstructor( ...opt ) {\n\t\tlet [ state, handlers, options ] = processStoreArgs( ...opt );  // eslint-disable-line prefer-const\n\t\tensureStoreOptions( options, handlers, this );\n\t\tconst namespace = options.namespace;\n\t\tObject.assign( this, options );\n\t\tstores[ namespace ] = this;\n\t\tlet inDispatch = false;\n\t\tthis.hasChanged = false;\n\n\t\tthis.getState = function() {\n\t\t\treturn state;\n\t\t};\n\n\t\tthis.setState = function( newState ) {\n\t\t\tif ( !inDispatch ) {\n\t\t\t\tthrow new Error( \"setState can only be called during a dispatch cycle from a store action handler.\" );\n\t\t\t}\n\t\t\tstate = Object.assign( state, newState );\n\t\t};\n\n\t\tthis.replaceState = function( newState ) {\n\t\t\tif ( !inDispatch ) {\n\t\t\t\tthrow new Error( \"replaceState can only be called during a dispatch cycle from a store action handler.\" );\n\t\t\t}\n\t\t\t// we preserve the underlying state ref, but clear it\n\t\t\tObject.keys( state ).forEach( function( key ) {\n\t\t\t\tdelete state[ key ];\n\t\t\t} );\n\t\t\tstate = Object.assign( state, newState );\n\t\t};\n\n\t\tthis.flush = function flush() {\n\t\t\tinDispatch = false;\n\t\t\tif ( this.hasChanged ) {\n\t\t\t\tthis.hasChanged = false;\n\t\t\t\tstoreChannel.publish( `${this.namespace}.changed` );\n\t\t\t}\n\t\t};\n\n\t\tmixin( this, mixin.actionListener( {\n\t\t\tcontext: this,\n\t\t\tchannel: dispatcherChannel,\n\t\t\ttopic: `${namespace}.handle.*`,\n\t\t\thandlers,\n\t\t\thandlerFn: function( data ) {\n\t\t\t\tif ( handlers.hasOwnProperty( data.actionType ) ) {\n\t\t\t\t\tinDispatch = true;\n\t\t\t\t\tconst res = handlers[ data.actionType ].handler.apply( this, data.actionArgs.concat( data.deps ) );\n\t\t\t\t\tthis.hasChanged = !( res === false );\n\t\t\t\t\tdispatcherChannel.publish(\n\t\t\t\t\t\t`${this.namespace}.handled.${data.actionType}`,\n\t\t\t\t\t\t{ hasChanged: this.hasChanged, namespace: this.namespace }\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}.bind( this )\n\t\t} ) );\n\n\t\tthis.__subscription = {\n\t\t\tnotify: dispatcherChannel.subscribe( \"notify\", () => this.flush() )\n\t\t\t\t\t.constraint( () => inDispatch )\n\t\t};\n\n\t\tdispatcher.registerStore(\n\t\t\t{\n\t\t\t\tnamespace,\n\t\t\t\tactions: buildActionList( handlers )\n\t\t\t}\n\t\t);\n\t}\n\n\t// Need to build in behavior to remove this store\n\t// from the dispatcher's actionMap as well!\n\tdispose() {\n\t\t/*eslint-disable */\n\t\tfor ( let [ k, subscription ] of entries( this.__subscription ) ) {\n\t\t\tsubscription.unsubscribe();\n\t\t}\n\t\t/*eslint-enable */\n\t\tdelete stores[ this.namespace ];\n\t\tdispatcher.removeStore( this.namespace );\n\t\tthis.luxCleanup();\n\t}\n}\n\nexport function removeStore( namespace ) {\n\tstores[ namespace ].dispose();\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/store.js\n **/"],"sourceRoot":""}